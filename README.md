# 勇者貪食蛇 RPG

一款以勇者隊伍為主題的 HTML5 Canvas 貪食蛇。玩家在網格上操控隊長收集道具、招募弓箭手／法師／騎士，並抵禦持續追擊的敵人。

## 版權聲明

Copyright © 2025 Yupo Huang. All rights reserved.

本遊戲及其所有代碼、資源、設計均為 Yupo Huang 的智慧財產權。未經授權，不得複製、修改、分發或商業使用。

## 專案結構

```
HeroSnakeRPG/
├── index.html              # 入口頁面，包含遊戲常數定義和 Firebase 初始化
├── style.css               # 所有樣式定義（包含響應式設計）
├── script.js               # 遊戲核心邏輯（約 2100 行）
├── guide-config.js         # 快速指引配置（企劃人員可直接修改）
├── upgrade-config.js       # 升級系統配置（企劃人員可直接修改）
├── enemy-spawn-config.js   # 怪物生成配置（企劃人員可直接修改）
├── hero-quotes-config.js   # 勇者今日名言配置（企劃人員可直接修改）
├── *.png                   # 角色與道具圖片（根目錄）
│   ├── leader.png          # 隊長
│   ├── archer.png          # 弓箭手
│   ├── mage.png            # 法師
│   ├── knight.png          # 騎士
│   ├── enemy.png           # 敵人
│   └── item.png            # 招募道具
├── docs/
│   ├── GDD.md              # 遊戲設計文件（詳細規則與參數）
│   ├── CHANGELOG.md        # 更新紀錄（包含程式結構說明）
│   ├── TECHNICAL-NOTES.md  # 技術筆記與 AI 開發導讀（重要！）
│   ├── UPGRADE-SYSTEM-README.md    # 升級系統配置說明
│   └── ENEMY-SPAWN-README.md       # 怪物生成配置說明
└── GUIDE-CONFIG-README.md  # 快速指引配置說明
```

## 執行方式

1. **直接開啟**：以瀏覽器開啟 `index.html`（支援 `file://` 協議）
2. **本地伺服器**（推薦）：使用任何靜態伺服器（如 VS Code Live Server、Python `http.server`）
3. **控制方式**：
   - **桌面**：使用方向鍵或 WASD 操控隊伍，或使用滑鼠拖曳滑動
   - **行動裝置**：使用滑動手勢控制方向（上下左右滑動）
4. **開始遊戲**：
   - 遊戲載入後顯示主選單
   - 輸入名字（若 localStorage 有記錄則自動帶入）
   - 點擊「開始遊戲」按鈕開始遊戲
   - 遊戲中可點擊按鈕查看排行榜或遊戲說明

## 核心功能

### 遊戲機制
- **網格移動**：隊長在網格上移動，收集道具招募勇者
- **線性插值**：使用時間基準的線性插值，確保移動均勻流暢
- **角色面向**：根據移動方向自動改變角色面向（左右翻轉）
- **血量系統**：隊長有血量，被撞扣血，擊殺敵人回復
- **職業系統**：弓箭手（遠程）、法師（範圍傷害）、騎士（防禦）
- **等級系統**：玩家有等級和經驗值，擊殺敵人獲得經驗值升級
- **碰撞效果**：怪物碰撞時被推開並緩停，我方單位顯示受傷閃爍（深紅色）
- **能力類型限制**：每輪遊戲最多可解鎖 10 種不同的能力類型，增加策略性
- **爆炸效果**：騎士死亡和箭矢命中時可觸發範圍爆炸傷害
- **視覺特效**：法師縮放動畫、爆炸特效等豐富的視覺反饋

### 輸入控制
- **鍵盤**：方向鍵或 WASD 控制方向
- **觸控**：滑動手勢控制方向（上下左右滑動），顯示軌跡線與箭頭
- **滑鼠**：拖曳滑動控制方向，與觸控體驗一致
- **升級系統**：升級時可選擇強化選項，各職業有多種升級路線
  - **能力類型限制**：每輪最多解鎖 10 種能力類型，需要策略選擇
  - **騎士**：可被攻擊次數、死亡獎勵、死亡爆炸範圍、死亡爆炸傷害、無敵
  - **弓箭手**：弓箭數量、射擊速度、箭矢爆炸範圍、箭矢爆炸傷害、必殺
  - **法師**：施法範圍、施法傷害、縮放效果、降速光環
  - **隊長**：血量、傷害、移動速度
- **怪物等級**：怪物有 1-8 級，等級越高越強，經驗值越多
- **測試功能**：遊戲中點擊🔧按鈕可進入測試修改模式（需密碼）

### UI 功能
- **主選單**：統一首頁，包含遊戲標題、名字輸入框、開始遊戲/排行榜/遊戲說明按鈕
- **載入畫面**：資產載入時顯示進度條，100% 後顯示「勇者今日名言」
- **等級系統**：等級和經驗值條顯示在遊戲視窗下方
- **排行榜 Modal**：
  - 點擊按鈕顯示全球前 5 名和今日前 5 名成績（依擊殺數排序）
  - 標題置中並有發光效果
  - X 按鈕在右上角，根據打開來源顯示/隱藏不同按鈕
  - 從主選單打開：只顯示 X 按鈕（隱藏重新開始和回主選單）
  - 從死亡時打開：顯示重新開始按鈕和 X 按鈕（隱藏回主選單）
- **遊戲說明 Modal**：
  - 點擊按鈕顯示圖文說明，內容可獨立配置
  - 操作方式顯示在最前面
  - X 按鈕在右上角，從遊戲中打開時關閉後會開始倒數
- **升級選擇**：升級時彈出三選一升級選項，暫停遊戲邏輯
- **倒數計時**：關閉 Modal 後顯示 3-2-1 倒數，給玩家準備時間
- **名字管理**：自動保存名字，上傳分數時自動使用
- **響應式設計**：Canvas 自動適配不同螢幕尺寸，維持 4:3 比例

### 技術特色
- **行動裝置優先**：Mobile First 設計，專為觸控操作優化
- **觸控手勢**：支援滑動手勢控制方向，無需虛擬按鈕
- **全螢幕相機系統**：Camera 跟隨角色，實現全螢幕遊戲體驗
- **小地圖系統**：左上角顯示小地圖，標示隊伍、敵人、道具和視野範圍
- **觸控視覺回饋**：滑動手勢顯示軌跡，提供操作反饋
- **響應式 Canvas**：自動適配不同螢幕尺寸，維持遊戲比例
- **降級機制**：圖片載入失敗時自動使用 Canvas 繪製替代圖形
- **平滑動畫**：使用 `requestAnimationFrame` 和插值實現流暢移動
- **碰撞檢測優化**：添加冷卻時間機制，避免頻繁觸發
- **傷害系統**：完整的傷害計算和視覺反饋系統
- **即時同步**：Firebase Firestore 即時排行榜更新
- **本地儲存**：使用 `localStorage` 保存玩家名字
- **配置分離**：升級系統、怪物生成等配置獨立為文件，方便企劃調整
- **多玩家預留**：顏色系統為未來的多玩家功能預留

## 文件

- **詳細規則與參數**：`docs/GDD.md`
- **更新紀錄與程式結構**：`docs/CHANGELOG.md`
- **技術筆記與 AI 導讀**：`docs/TECHNICAL-NOTES.md` ⭐
- **快速指引配置說明**：`GUIDE-CONFIG-README.md`
- **升級系統配置說明**：`docs/UPGRADE-SYSTEM-README.md`
- **怪物生成配置說明**：`docs/ENEMY-SPAWN-README.md`

## 第三方服務

- **Firebase Firestore**：儲存與即時同步全球排行榜
  - 需要網路連線才可上傳／讀取分數
  - 配置已整合在 `index.html` 中

## 開發說明

### 修改遊戲參數
所有遊戲常數定義在 `index.html` 的 `<script>` 標籤開頭，可直接修改：
```javascript
const GRID_SIZE = 40;
const GAME_SPEED = 150;
// ...
```

### 修改勇者今日名言
直接編輯 `hero-quotes-config.js` 檔案，可新增、修改或刪除名言。

### 修改快速指引
直接編輯 `guide-config.js` 檔案，修改後重新整理頁面即可看到更新。

### 修改升級系統
直接編輯 `upgrade-config.js` 檔案，可調整等級經驗值、怪物屬性、升級選項等。
詳細說明請參考 `docs/UPGRADE-SYSTEM-README.md`。

### 修改怪物生成
直接編輯 `enemy-spawn-config.js` 檔案，可調整各玩家等級階段會出現的怪物等級及其機率。
詳細說明請參考 `docs/ENEMY-SPAWN-README.md`。

### 程式結構
- **核心邏輯**：`script.js` 包含所有遊戲邏輯（約 2100 行）
- **主要變數**：遊戲狀態、移動系統、玩家系統、計分系統
- **主要函數**：遊戲循環、碰撞檢測、職業技能、UI 管理、資源管理
- **配置文件**：`upgrade-config.js`、`enemy-spawn-config.js`、`guide-config.js`、`hero-quotes-config.js`
- 詳細說明請參考 `docs/CHANGELOG.md` 的「程式結構說明」章節
- **技術筆記**：開發過程中的重要問題和解決方案請參考 `docs/TECHNICAL-NOTES.md` ⭐

## 授權

本專案採 MIT License 授權，詳見 `LICENSE`。
