# 升級系統配置說明

## 📝 檔案位置

升級系統的所有平衡參數都存放在 **`upgrade-config.js`** 檔案中，企劃人員可以直接修改此檔案來調整遊戲平衡。

## 🎯 配置結構

### 1. 等級與經驗值系統

```javascript
leveling: {
  baseExp: 25,         // 基礎經驗值需求（從 40 降低到 25，讓升級更快更容易）
  expMultiplier: 1.1,  // 經驗值成長倍率（從 1.15 降低到 1.1，讓高等級升級更容易）
}
```

**計算公式**：`所需經驗值 = baseExp * (等級 ^ expMultiplier)`

**範例**：
- 等級 1 → 2：25 * (2^1.1) ≈ 54
- 等級 2 → 3：25 * (3^1.1) ≈ 85
- 等級 3 → 4：25 * (4^1.1) ≈ 118

**調整建議**：
- 覺得升級太快：增加 `baseExp` 或 `expMultiplier`
- 覺得升級太慢：減少 `baseExp` 或 `expMultiplier`

### 2. 怪物等級系統

```javascript
enemyLevel: {
  minLevel: 1,        // 最低等級
  maxLevel: 8,        // 最高等級（從 10 改為 8）
  baseHp: 20,         // 等級 1 的基礎血量
  hpPerLevel: 30,     // 每級增加的血量（從 20 增加到 30）
  baseDamage: 35,     // 等級 1 的基礎傷害
  damagePerLevel: 10,   // 每級增加的傷害（從 7 增加到 10）
  baseExp: 10,        // 等級 1 的基礎經驗值（實際經驗值使用非線性公式計算）
}
```

**等級計算公式**：
- **血量**：
  - 等級 1-4：`baseHp + (level - 1) * hpPerLevel`
    - 等級 1：20 HP
    - 等級 4：110 HP
  - 等級 5 以上：等級 4 基礎血量 + (level - 4) * (hpPerLevel * 1.5)
    - 等級 5：155 HP
    - 等級 8：290 HP
- **傷害**：`baseDamage + (level - 1) * damagePerLevel`
  - 等級 1：35 傷害
  - 等級 8：105 傷害
- **經驗值**：`baseExp * level * (1 + (level - 1) * 0.3)`（非線性成長）
  - 等級 1：10 經驗值
  - 等級 8：248 經驗值
- **移動速度**：
  - 等級 1-4：每級約 +4.3%（等級 1 = 100%，等級 4 = 113%）
  - 等級 5 以上：每級額外增加 7% 速度（等級 5 = 120%，等級 8 = 150%）

**等級提升規則**：
- 基礎等級：1
- 時間加成：每 `timeScale` 毫秒提升 1 級
- 玩家等級加成：每 `levelScale` 級玩家等級提升 1 級怪物等級
- 最終等級 = 基礎等級 + 時間加成 + 玩家等級加成
- 等級會被限制在 `minLevel` 和 `maxLevel` 之間（1-10級）

**調整建議**：
- 增加怪物難度：提高 `hpPerLevel`、`damagePerLevel`
- 增加獎勵：提高 `baseExp` 或調整經驗值公式
- 調整等級範圍：修改 `minLevel` 和 `maxLevel`
- 調整成長速度：修改 `timeScale` 和 `levelScale`

### 3. 升級選項配置

每個職業都有多個可升級的選項：

```javascript
upgrades: {
  mage: {
    auraRange: {
      name: "施法範圍",
      description: "法師光環範圍 +{value} 像素",
      baseValue: 80,      // 基礎範圍
      increment: 10,      // 每次升級增加的值
      maxLevel: 8,        // 最大等級
      icon: "mage.png",   // 圖示
    },
    // ... 更多選項
  },
  // ... 其他職業
}
```

**可調整參數**：
- `baseValue`：基礎數值（通常對應遊戲常數）
- `increment`：每次升級增加的值
- `maxLevel`：最大等級（達到後不再出現此選項）
- `name`：顯示名稱
- `description`：說明文字（`{value}` 會被替換為 `increment`）

**調整建議**：
- 增強效果：增加 `increment` 或 `maxLevel`
- 削弱效果：減少 `increment` 或 `maxLevel`
- 平衡性：確保各職業選項的強度相當

### 4. 滿級後統一效果

```javascript
maxedOutBonus: {
  hpIncrease: 1,  // 每次升級增加的最大 HP
}
```

當所有升級選項都達到最大等級後，每次升級統一增加隊長最大 HP。

**調整建議**：
- 增加獎勵：提高 `hpIncrease`
- 減少獎勵：降低 `hpIncrease`

## ⚠️ 注意事項

1. **數值平衡**：修改參數時請注意各系統之間的平衡
   - 怪物強度應該與玩家升級速度匹配
   - 升級效果不應該過於強大或弱小

2. **JSON 格式**：修改時請注意逗號和引號的正確使用

3. **重新整理**：修改後請重新整理瀏覽器頁面以看到更新

4. **測試建議**：
   - 先調整小幅度數值測試效果
   - 記錄修改前後的數值，方便回退
   - 測試不同等級的遊戲體驗

## 📋 各職業升級選項總覽

### 法師 (Mage)
- **施法範圍**：光環範圍 +10 像素（最大 Lv 8）
- **施法傷害**：光環傷害 +3/級（最大 Lv 5）
- **縮放效果**：光環縮放百分比 +10%/級（最大 Lv 5）
- **降速光環**：光圈內的敵人速度 -12%/級（最大 Lv 5）

### 弓箭手 (Archer)
- **弓箭數量**：每次攻擊發射箭矢數量 +1（最大 Lv 5，從 Lv 3 上修）
- **射擊速度**：箭矢飛行速度 +1，射擊頻率提升（最大 Lv 8，從 Lv 10 下修）
  - 每級減少 10% 冷卻時間（最多減少到 50%，即冷卻時間減半）
  - 例如：等級 0 = 1000ms 冷卻，等級 5 = 500ms 冷卻，等級 8 = 500ms 冷卻
- **箭矢爆炸**：命中怪物後爆炸範圍 +50px/級，傷害 +2/級（最大 Lv 5）
- **必殺 (Critical)**：5%/級機率造成 2 倍傷害（最大 Lv 10）

### 騎士 (Knight)
- **可被攻擊次數**：騎士可承受的攻擊次數 +1（最大 Lv 5，從 Lv 10 下修）
  - 初始次數為 1
  - 越接近消失會依照比例越來越透明，但邊框不會跟著透明
  - 升級時，場上所有現有騎士的 hitPoints 會增加對應的增量
- **死亡後增加隊伍長度**：騎士死亡時隊伍長度 +1（最大 Lv 3）
- **受傷爆炸**：騎士受傷時爆炸範圍 +70px/級，傷害 +5/級（最大 Lv 8）
- **無敵**：死亡後全隊無敵 N 秒（最大 Lv 5）

### 隊長 (Leader)
- **血量**：隊長最大血量 +5（最大 Lv 10）
- **傷害**：隊長撞擊敵人傷害 +1（最大 Lv 5）
  - 注意：此功能需要實作隊長撞擊傷害系統

## 🔧 進階調整

### 怪物強度隨時間提升

```javascript
enemyScaling: {
  timeScale: 30000,    // 每 30 秒提升一個強度等級（毫秒）
  levelScale: 5,       // 每 5 級提升一個強度等級
}
```

**調整建議**：
- 加快難度提升：減少 `timeScale` 或 `levelScale`
- 減慢難度提升：增加 `timeScale` 或 `levelScale`

### 升級選項生成規則

- 每次升級時會隨機生成 3 個選項
- 優先從不同職業中選擇，確保多樣性
- 使用加權隨機系統：
  - 已解鎖未滿級選項：權重 1.5（出現機率提高 50%）
  - 未解鎖選項：權重 1.0（正常機率）
  - 滿級選項：權重 0.5（降低出現機率）
- 如果所有選項都滿級，會顯示滿級選項（效果：隊長最大HP+1）

### 能力類型限制系統

```javascript
abilityTypeLimit: 8,  // 能力類型上限（從 10 降低到 8）
```

- 每輪遊戲最多可解鎖 8 種不同的能力類型
- 達到上限後，未解鎖的選項會變半透明且無法選擇
- 已解鎖的選項可以繼續升級，不受限制
- 滿級選擇（隊長最大血量+1）不計入能力類型限制

## 📊 平衡測試檢查清單

- [ ] 等級 1-5：玩家應該能輕鬆升級
- [ ] 等級 5-10：難度開始提升，需要策略
- [ ] 等級 10+：挑戰性高，但仍有成長空間
- [ ] 各職業升級選項強度相當
- [ ] 怪物強度與玩家成長速度匹配
- [ ] 滿級後的統一效果有吸引力

